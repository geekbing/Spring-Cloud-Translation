
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>应用上下文层次结构 · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="Changing the Location of Bootstrap Properties.html" />
    
    
    <link rel="prev" href="The Bootstrap Application Context.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                    本书说明
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../../Introduction/spring-cloud-introduce.html">
            
                <a href="../../Introduction/spring-cloud-introduce.html">
            
                    
                    Spring Cloud 简介
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../../Introduction/Features.html">
            
                <a href="../../Introduction/Features.html">
            
                    
                    Spring Cloud 特色
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../Cloud Native Applications.html">
            
                <a href="../Cloud Native Applications.html">
            
                    
                    原生云应用
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="Spring Cloud Context.html">
            
                <a href="Spring Cloud Context.html">
            
                    
                    Spring Cloud 上下文
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1.1" data-path="The Bootstrap Application Context.html">
            
                <a href="The Bootstrap Application Context.html">
            
                    
                    应用程序引导上下文
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.1.2" data-path="Application Context Hierarchies.html">
            
                <a href="Application Context Hierarchies.html">
            
                    
                    应用上下文层次结构
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.3" data-path="Changing the Location of Bootstrap Properties.html">
            
                <a href="Changing the Location of Bootstrap Properties.html">
            
                    
                    更改引导属性的位置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.1.4" data-path="Overriding the Values of Remote Properties.html">
            
                <a href="Overriding the Values of Remote Properties.html">
            
                    
                    覆盖远程属性的值
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >应用上下文层次结构</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x5E94;&#x7528;&#x4E0A;&#x4E0B;&#x6587;&#x5C42;&#x6B21;&#x7ED3;&#x6784;">&#x5E94;&#x7528;&#x4E0A;&#x4E0B;&#x6587;&#x5C42;&#x6B21;&#x7ED3;&#x6784;</h1>
<p>&#x5982;&#x679C;&#x4F60;&#x4ECE;SpringApplication&#x6216;SpringApplicationBuilder&#x6765;&#x6784;&#x5EFA;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#xFF0C;&#x5219;Spring Cloud&#x4F1A;&#x5C06;&#x5F15;&#x5BFC;&#x4E0A;&#x4E0B;&#x6587;&#x6DFB;&#x52A0;&#x4E3A;&#x5B83;&#x7684;&#x7236;&#x4E0A;&#x4E0B;&#x6587;&#x3002;Spring&#x7684;&#x4E00;&#x4E2A;&#x7279;&#x70B9;&#x5C31;&#x662F;&#xFF0C;&#x5B50;&#x4E0A;&#x4E0B;&#x6587;&#x4F1A;&#x4ECE;&#x5B83;&#x4EEC;&#x7684;&#x7236;&#x4E0A;&#x4E0B;&#x6587;&#x7EE7;&#x627F;&#x5C5E;&#x6027;&#x6E90;&#x548C;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x4E0E;&#x4E0D;&#x4F7F;&#x7528;Spring Cloud Config&#x6784;&#x5EFA;&#x76F8;&#x540C;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x76F8;&#x6BD4;&#xFF0C;&#x4E3B;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#x5C06;&#x5305;&#x542B;&#x989D;&#x5916;&#x7684;&#x5C5E;&#x6027;&#x6E90;&#x3002;&#x5176;&#x4ED6;&#x5C5E;&#x6027;&#x6E90;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li><p>&#x201C;bootstrap&#x201D;&#xFF1A;&#x5982;&#x679C;&#x5728;&#x5F15;&#x5BFC;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x627E;&#x5230;&#x4EFB;&#x4F55;PropertySourceLocators&#xFF0C;&#x5E76;&#x4E14;&#x5B83;&#x4EEC;&#x5177;&#x6709;&#x975E;&#x7A7A;&#x5C5E;&#x6027;&#xFF0C;&#x5219;&#x53EF;&#x9009;&#x7684;CompositePropertySource&#x5C06;&#x663E;&#x793A;&#x4E3A;&#x9AD8;&#x4F18;&#x5148;&#x7EA7;&#x3002; &#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x5C31;&#x662F;&#x6765;&#x81EA;Spring Cloud&#x914D;&#x7F6E;&#x670D;&#x52A1;&#x5668;&#x7684;&#x5C5E;&#x6027;&#x3002; &#x6709;&#x5173;&#x5982;&#x4F55;&#x81EA;&#x5B9A;&#x4E49;&#x6B64;&#x5C5E;&#x6027;&#x6E90;&#x7684;&#x5185;&#x5BB9;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x4E0B;&#x6587;&#x3002;</p>
</li>
<li><p>&#x201C;applicationConfig&#xFF1A;[classpath&#xFF1A;bootstrap.yml]&#x201D;&#xFF08;&#x5982;&#x679C;Spring&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x662F;&#x6FC0;&#x6D3B;&#x7684;&#xFF09;&#x3002; &#x5982;&#x679C;&#x4F60;&#x6709;&#x4E00;&#x4E2A;bootstrap.yml&#xFF08;&#x6216;properties&#xFF09;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x5C06;&#x7528;&#x4E8E;&#x914D;&#x7F6E;&#x5F15;&#x5BFC;&#x4E0A;&#x4E0B;&#x6587;&#x3002;&#x5F53;&#x5B50;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x7236;&#x4E0A;&#x4E0B;&#x6587;&#x8BBE;&#x7F6E;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5B83;&#x4EEC;&#x5C06;&#x88AB;&#x6DFB;&#x52A0;&#x5230;&#x5B50;&#x4E0A;&#x4E0B;&#x6587;&#x4E2D;&#x3002; &#x5B83;&#x4EEC;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#x4F4E;&#x4E8E;application.yml&#xFF08;&#x6216;properties&#xFF09;&#x4EE5;&#x53CA;&#x521B;&#x5EFA;Spring Boot&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x8FC7;&#x7A0B;&#x4E2D;&#x6B63;&#x5E38;&#x6DFB;&#x52A0;&#x5230;&#x5B50;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5176;&#x4ED6;&#x4EFB;&#x4F55;&#x5C5E;&#x6027;&#x6E90;&#x3002; &#x6709;&#x5173;&#x5982;&#x4F55;&#x81EA;&#x5B9A;&#x4E49;&#x8FD9;&#x4E9B;&#x5C5E;&#x6027;&#x6E90;&#x7684;&#x5185;&#x5BB9;&#x7684;&#x8BF4;&#x660E;&#xFF0C;&#x8BF7;&#x53C2;&#x9605;&#x4E0B;&#x6587;&#x3002;</p>
</li>
</ul>
<p>&#x7531;&#x4E8E;&#x5C5E;&#x6027;&#x6E90;&#x7684;&#x6392;&#x5E8F;&#x89C4;&#x5219;&#xFF0C;&#x201C;&#x5F15;&#x5BFC;&#x201D;&#x6761;&#x76EE;&#x4F18;&#x5148;&#xFF0C;&#x4F46;&#x662F;&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;&#x8FD9;&#x4E9B;&#x4E0D;&#x5305;&#x542B;&#x6765;&#x81EA;bootstrap.yml&#x7684;&#x4EFB;&#x4F55;&#x6570;&#x636E;&#xFF0C;&#x8BE5;&#x6570;&#x636E;&#x5177;&#x6709;&#x975E;&#x5E38;&#x4F4E;&#x7684;&#x4F18;&#x5148;&#x7EA7;&#xFF0C;&#x4F46;&#x53EF;&#x4EE5;&#x7528;&#x4E8E;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x503C;&#x3002;</p>
<p>&#x4F60;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x7B80;&#x5355;&#x5730;&#x8BBE;&#x7F6E;&#x4F60;&#x521B;&#x5EFA;&#x7684;&#x4EFB;&#x4F55;ApplicationContext&#x7684;&#x7236;&#x4E0A;&#x4E0B;&#x6587;&#x6765;&#x6269;&#x5C55;&#x4E0A;&#x4E0B;&#x6587;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x3002;&#x4F8B;&#x5982;&#xFF1A;&#x4F7F;&#x7528;&#x5B83;&#x81EA;&#x5DF1;&#x7684;&#x63A5;&#x53E3;&#xFF0C;&#x6216;&#x8005;&#x7528;SpringApplicationBuilder&#x7684;&#x4FBF;&#x6377;&#x65B9;&#x6CD5;&#xFF08;parent&#xFF08;&#xFF09;&#xFF0C;child&#xFF08;&#xFF09;&#x548C;sibling&#xFF08;&#xFF09;&#xFF09;&#x3002;&#x5F15;&#x5BFC;&#x4E0A;&#x4E0B;&#x6587;&#x5C06;&#x662F;&#x4F60;&#x81EA;&#x5DF1;&#x521B;&#x5EFA;&#x7684;&#x6700;&#x9AD8;&#x7EA7;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x7236;&#x7EA7;&#x3002;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x4E0A;&#x4E0B;&#x6587;&#x90FD;&#x6709;&#x81EA;&#x5DF1;&#x7684;&#x201C;&#x5F15;&#x5BFC;&#x201D;&#x5C5E;&#x6027;&#x6E90;&#xFF08;&#x53EF;&#x80FD;&#x4E3A;&#x7A7A;&#xFF09;&#xFF0C;&#x4EE5;&#x907F;&#x514D;&#x5C06;&#x503C;&#x4ECE;&#x7236;&#x7EA7;&#x65E0;&#x610F;&#x95F4;&#x5411;&#x4E0B;&#x63A8;&#x9001;&#x5230;&#x5176;&#x540E;&#x4EE3;&#x3002;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x4E0A;&#x4E0B;&#x6587;&#xFF08;&#x539F;&#x5219;&#x4E0A;&#xFF09;&#x4E5F;&#x53EF;&#x4EE5;&#x5177;&#x6709;&#x4E0D;&#x540C;&#x7684;  <code>spring.application.name</code>&#xFF0C;&#x5982;&#x679C;&#x6709;&#x4E00;&#x4E2A;&#x914D;&#x7F6E;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8BDD;&#xFF0C;&#x4E5F;&#x53EF;&#x80FD;&#x5177;&#x6709;&#x4E0D;&#x540C;&#x7684;&#x8FDC;&#x7A0B;&#x5C5E;&#x6027;&#x6E90;&#x3002;&#x901A;&#x5E38;&#x7684;Spring&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E0A;&#x4E0B;&#x6587;&#x884C;&#x4E3A;&#x89C4;&#x5219;&#x9002;&#x7528;&#x4E8E;&#x5C5E;&#x6027;&#x89E3;&#x6790;&#xFF1A;&#x6765;&#x81EA;&#x5B50;&#x4EE3;&#x4E0A;&#x4E0B;&#x6587;&#x7684;&#x5C5E;&#x6027;&#x6839;&#x636E;&#x540D;&#x79F0;&#x4EE5;&#x53CA;&#x5C5E;&#x6027;&#x6E90;&#x540D;&#x79F0;&#x8986;&#x76D6;&#x7236;&#x7EA7;&#x4E2D;&#x7684;&#x5C5E;&#x6027;&#xFF08;&#x5982;&#x679C;&#x5B50;&#x7EA7;&#x5177;&#x6709;&#x4E0E;&#x7236;&#x7EA7;&#x76F8;&#x540C;&#x540D;&#x79F0;&#x7684;&#x5C5E;&#x6027;&#x6E90;&#xFF0C;&#x5219;&#x7236;&#x9879;&#x4E0D;&#x5305;&#x62EC;&#x5728;&#x5B50;&#x9879;&#x4E2D;&#xFF09;&#x3002;</p>
<p>&#x8BF7;&#x6CE8;&#x610F;&#xFF0C;SpringApplicationBuilder&#x5141;&#x8BB8;&#x4F60;&#x5728;&#x6574;&#x4E2A;&#x4E0A;&#x4E0B;&#x6587;&#x5C42;&#x6B21;&#x7ED3;&#x6784;&#x4E4B;&#x95F4;&#x5171;&#x4EAB;&#x73AF;&#x5883;&#x914D;&#x7F6E;&#xFF0C;&#x4F46;&#x8FD9;&#x4E0D;&#x662F;&#x9ED8;&#x8BA4;&#x7684;&#x3002;&#x56E0;&#x6B64;&#xFF0C;&#x5144;&#x5F1F;&#x4E0A;&#x4E0B;&#x6587;&#x7279;&#x522B;&#x4E0D;&#x9700;&#x8981;&#x5177;&#x6709;&#x76F8;&#x540C;&#x7684;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x6216;&#x5C5E;&#x6027;&#x6E90;&#xFF0C;&#x5373;&#x4F7F;&#x5B83;&#x4EEC;&#x5C06;&#x4E0E;&#x5B83;&#x4EEC;&#x7684;&#x7236;&#x4EE3;&#x5171;&#x4EAB;&#x5171;&#x540C;&#x7684;&#x4E1C;&#x897F;&#x3002;</p>
<hr>
<h1 id="application-context-hierarchies">Application Context Hierarchies</h1>
<p>If you build an application context from SpringApplication or SpringApplicationBuilder, then the Bootstrap context is added as a parent to that context. It is a feature of Spring that child contexts inherit property sources and profiles from their parent, so the &quot;main&quot; application context will contain additional property sources, compared to building the same context without Spring Cloud Config. The additional property sources are:</p>
<ul>
<li><p>&quot;bootstrap&quot;: an optional CompositePropertySource appears with high priority if any PropertySourceLocators are found in the Bootstrap context, and they have non-empty properties. An example would be properties from the Spring Cloud Config Server. See below for instructions on how to customize the contents of this property source.</p>
</li>
<li><p>&quot;applicationConfig: [classpath:bootstrap.yml]&quot; (and friends if Spring profiles are active). If you have a bootstrap.yml (or properties) then those properties are used to configure the Bootstrap context, and then they get added to the child context when its parent is set. They have lower precedence than the application.yml (or properties) and any other property sources that are added to the child as a normal part of the process of creating a Spring Boot application. See below for instructions on how to customize the contents of these property sources.</p>
</li>
</ul>
<p>Because of the ordering rules of property sources the &quot;bootstrap&quot; entries take precedence, but note that these do not contain any data from bootstrap.yml, which has very low precedence, but can be used to set defaults.</p>
<p>You can extend the context hierarchy by simply setting the parent context of any ApplicationContext you create, e.g. using its own interface, or with the SpringApplicationBuilder convenience methods (parent(), child() and sibling()). The bootstrap context will be the parent of the most senior ancestor that you create yourself. Every context in the hierarchy will have its own &quot;bootstrap&quot; property source (possibly empty) to avoid promoting values inadvertently from parents down to their descendants. Every context in the hierarchy can also (in principle) have a different spring.application.name and hence a different remote property source if there is a Config Server. Normal Spring application context behaviour rules apply to property resolution: properties from a child context override those in the parent, by name and also by property source name (if the child has a property source with the same name as the parent, the one from the parent is not included in the child).</p>
<p>Note that the SpringApplicationBuilder allows you to share an Environment amongst the whole hierarchy, but that is not the default. Thus, sibling contexts in particular do not need to have the same profiles or property sources, even though they will share common things with their parent.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="The Bootstrap Application Context.html" class="navigation navigation-prev " aria-label="Previous page: 应用程序引导上下文">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="Changing the Location of Bootstrap Properties.html" class="navigation navigation-next " aria-label="Next page: 更改引导属性的位置">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"应用上下文层次结构","level":"1.4.1.2","depth":3,"next":{"title":"更改引导属性的位置","level":"1.4.1.3","depth":3,"path":"Cloud Native Applications/Spring Cloud Context/Changing the Location of Bootstrap Properties.md","ref":"Cloud Native Applications/Spring Cloud Context/Changing the Location of Bootstrap Properties.md","articles":[]},"previous":{"title":"应用程序引导上下文","level":"1.4.1.1","depth":3,"path":"Cloud Native Applications/Spring Cloud Context/The Bootstrap Application Context.md","ref":"Cloud Native Applications/Spring Cloud Context/The Bootstrap Application Context.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Cloud Native Applications/Spring Cloud Context/Application Context Hierarchies.md","mtime":"2017-02-21T02:17:13.000Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2017-02-21T02:00:12.283Z"},"basePath":"../..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

